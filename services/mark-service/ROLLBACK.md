# üîÑ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ç–∫–∞—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–º–∏—Ç–µ

**–ö–æ–º–º–∏—Ç**: Complete NestJS Mark Service Implementation
**–î–∞—Ç–∞**: 2025-10-10
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Mark Service —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π QR-–∫–æ–¥–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

### –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:
- Database schema (PostgreSQL + TypeORM)
- –°–µ—Ä–≤–∏—Å—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–∞—Ä–æ–∫
- REST API —Å 11 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏
- QR code generation —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º
- Redis caching
- Rate limiting
- Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- Prometheus –º–µ—Ç—Ä–∏–∫–∏
- Unit –∏ E2E —Ç–µ—Å—Ç—ã
- SQL –º–∏–≥—Ä–∞—Ü–∏–∏
- –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## ‚ö†Ô∏è –ü–µ—Ä–µ–¥ –æ—Ç–∫–∞—Ç–æ–º

**–í–ê–ñ–ù–û**: –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git stash save "–ú–æ–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–∫–∞—Ç–æ–º"
```

## üîô –°–ø–æ—Å–æ–±—ã –æ—Ç–∫–∞—Ç–∞

### –°–ø–æ—Å–æ–± 1: –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—à–∏–ª–∏)

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–º–º–∏—Ç, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
git reset --soft HEAD~1

# –ò–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–º–º–∏—Ç –∏ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git reset --hard HEAD~1
```

### –°–ø–æ—Å–æ–± 2: –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ push –≤ GitHub

```bash
# 1. –£–∑–Ω–∞–π—Ç–µ —Ö–µ—à –∫–æ–º–º–∏—Ç–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É —Ö–æ—Ç–∏—Ç–µ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è
git log --oneline -10

# 2. –û—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –∫ –Ω—É–∂–Ω–æ–º—É –∫–æ–º–º–∏—Ç—É (–∑–∞–º–µ–Ω–∏—Ç–µ COMMIT_HASH)
git reset --hard COMMIT_HASH

# 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—à—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–û–°–¢–û–†–û–ñ–ù–û!)
git push --force origin main
```

### –°–ø–æ—Å–æ–± 3: –°–æ–∑–¥–∞—Ç—å reverting –∫–æ–º–º–∏—Ç (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–±)

```bash
# 1. –ù–∞–π–¥–∏—Ç–µ —Ö–µ—à –∫–æ–º–º–∏—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å
git log --oneline -10

# 2. –°–æ–∑–¥–∞–π—Ç–µ reverting –∫–æ–º–º–∏—Ç (–∑–∞–º–µ–Ω–∏—Ç–µ COMMIT_HASH)
git revert COMMIT_HASH

# 3. –ó–∞–ø—É—à—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git push origin main
```

### –°–ø–æ—Å–æ–± 4: –û—Ç–∫–∞—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
git checkout HEAD~1 -- services/mark-service/src/main.ts

# –ò–ª–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–æ–º–º–∏—Ç—É
git checkout COMMIT_HASH -- services/mark-service/src/main.ts

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "Rollback specific files"
git push origin main
```

## üì¶ –û—Ç–∫–∞—Ç –ø–∞–∫–µ—Ç–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
cd services/mark-service

# –£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
rm -rf node_modules
rm pnpm-lock.yaml

# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ package.json
git checkout HEAD~1 -- package.json

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pnpm install
```

## üóÑÔ∏è –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
psql -U postgres -d znak_lavki << EOF
DROP TABLE IF EXISTS audit_logs CASCADE;
DROP TABLE IF EXISTS quality_marks CASCADE;
DROP TYPE IF EXISTS mark_status CASCADE;
DROP TYPE IF EXISTS audit_action CASCADE;
DROP FUNCTION IF EXISTS update_updated_at_column CASCADE;
EOF
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤
git log --oneline -10

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
git status

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git diff HEAD~1
```

## üíæ –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫–∞—Ç–æ–º

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
git branch backup-mark-service-$(date +%Y%m%d)

# –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç–µ–≥
git tag -a mark-service-backup-$(date +%Y%m%d) -m "Backup before rollback"
git push origin --tags
```

## üöÄ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞

–ï—Å–ª–∏ –≤—ã –æ—Ç–∫–∞—Ç–∏–ª–∏—Å—å –∏ —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è:

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è (–≤–∫–ª—é—á–∞—è –æ—Ç–∫–∞—Ç—ã)
git reflog

# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω—É–∂–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é (–∑–∞–º–µ–Ω–∏—Ç–µ COMMIT_HASH)
git reset --hard COMMIT_HASH

# –ò–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
git checkout backup-mark-service-YYYYMMDD
```

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç (–û–°–¢–û–†–û–ñ–ù–û - —É–¥–∞–ª–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è!)
```bash
cd "/Users/rparamzin/Desktop/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π/–ó–Ω–∞–∫ –ª–∞–≤–∫–∏"
git reset --hard HEAD~1
git push --force origin main
```

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ—Ç–∫–∞—Ç (—Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç)
```bash
cd "/Users/rparamzin/Desktop/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π/–ó–Ω–∞–∫ –ª–∞–≤–∫–∏"
git revert HEAD
git push origin main
```

## üìû –ü–æ–º–æ—â—å

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –æ–ø–µ—Ä–∞—Ü–∏—é
git reflog
git reset --hard HEAD@{1}

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ stash
git stash list
git stash apply stash@{0}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **--force push –æ–ø–∞—Å–µ–Ω** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã
2. **–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø** –ø–µ—Ä–µ–¥ –æ—Ç–∫–∞—Ç–æ–º
3. **git revert –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ** —á–µ–º git reset –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å** –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π

## üìä –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö)

```bash
# –£–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
git clean -fd

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)
git clean -fd --dry-run
```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**: 2025-10-10  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-10-10

